--- build/tmp/openapi-templates/kotlin-client/build.gradle.mustache	2022-06-14 09:23:23.027125874 -0400
+++ build/resources/patches/kotlin-client/build.gradle.mustache	2022-06-28 09:35:13.506680799 -0400
@@ -2,7 +2,7 @@
 {{^omitGradleWrapper}}

 wrapper {
-    gradleVersion = '7.5'
+    gradleVersion = '{{gradleVersion}}'
     distributionUrl = "https://services.gradle.org/distributions/gradle-$gradleVersion-all.zip"
 }
 {{/omitGradleWrapper}}
@@ -12,2 +12,2 @@
-    ext.kotlin_version = '1.6.10'
+    ext.kotlin_version = '1.7.20'
     {{#jvm-ktor}}
@@ -54,6 +54,12 @@
 apply plugin: 'idea'
 {{/idea}}

+files(
+    "local.build.gradle",
+    "local.build.gradle.kts",
+).filter({ it.exists() } as Spec)
+    .forEach({ apply from: it })
+
 repositories {
     maven { url "https://repo1.maven.org/maven2" }
 }
@@ -172,3 +147,10 @@
     }
 }
 {{/kotlinx_serialization}}
+{{#moshi}}
+tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).configureEach {
+    kotlinOptions {
+        freeCompilerArgs += "-Xopt-in=kotlin.RequiresOptIn"
+    }
+}
+{{/moshi}}
